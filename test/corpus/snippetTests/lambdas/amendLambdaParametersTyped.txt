===
lambdas/amendLambdaParametersTyped.pkl
===

import "pkl:test"

example1 {
  local f = (x) -> new Dynamic {}
  result = (f) { x: Int -> prop = x + 1 }.apply(1)
}

example2 {
  local f = (x, y) -> new Dynamic {}
  result = (f) { a, b: Number -> prop = a + b }.apply(1, 2)
}

example3 {
  local f = (x, y) -> new Dynamic {}
  result = test.catch(() -> (f) { a, b: Number(this > 3) -> prop = a + b }.apply(1, 2))
}

example4 {
  local f = (x, y) -> (z) -> new Dynamic { prop3 = z }
  result = test.catch(() -> (f) { a: String, b -> prop1 = a; prop2 = b }.apply(1, 2).apply(3))
}

class Foo
class Bar
class Baz

example5 {
  local f = (x, y, z) -> new Dynamic { prop3 = z }
  result = (f) { a: Foo, b: Bar, c: Baz -> prop1 = a; prop2 = b }.apply(new Foo {}, new Bar {}, new Baz {})
}

example6 {
  local f = (x, y, z) -> new Dynamic { prop3 = z }
  result = test.catch(() -> (f) { a: Baz, b: Bar, c: Foo -> prop1 = a; prop2 = b }.apply(new Foo {}, new Bar {}, new Baz {}))
}

---

(module
  (importClause
    (stringConstant
      (slStringLiteralPart)))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier)))
          (newExpr
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (objectBody))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (amendExpr
            (parenthesizedExpr
              (unqualifiedAccessExpr
                (identifier)))
            (objectBody
              (objectBodyParameters

                (typedIdentifier
                  (identifier)
                  (typeAnnotation
                    (declaredType
                      (qualifiedIdentifier
                        (identifier))))))
              (objectProperty
                (identifier)
                (additiveExpr
                  (unqualifiedAccessExpr
                    (identifier))
                  (intLiteralExpr)))))
          (identifier)
          (argumentList
            (intLiteralExpr))))))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier)))
          (newExpr
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (objectBody))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (amendExpr
            (parenthesizedExpr
              (unqualifiedAccessExpr
                (identifier)))
            (objectBody
              (objectBodyParameters

                (typedIdentifier
                  (identifier))
                (typedIdentifier
                  (identifier)
                  (typeAnnotation
                    (declaredType
                      (qualifiedIdentifier
                        (identifier))))))
              (objectProperty
                (identifier)
                (additiveExpr
                  (unqualifiedAccessExpr
                    (identifier))
                  (unqualifiedAccessExpr
                    (identifier))))))
          (identifier)
          (argumentList
            (intLiteralExpr)
            (intLiteralExpr))))))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier)))
          (newExpr
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (objectBody))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (unqualifiedAccessExpr
            (identifier))
          (identifier)
          (argumentList
            (functionLiteralExpr
              (parameterList)
              (qualifiedAccessExpr
                (amendExpr
                  (parenthesizedExpr
                    (unqualifiedAccessExpr
                      (identifier)))
                  (objectBody
                    (objectBodyParameters

                      (typedIdentifier
                        (identifier))
                      (typedIdentifier
                        (identifier)
                        (typeAnnotation
                          (constrainedType
                            (declaredType
                              (qualifiedIdentifier
                                (identifier)))
                            (comparisonExpr
                              (thisExpr)
                              (intLiteralExpr))))))
                    (objectProperty
                      (identifier)
                      (additiveExpr
                        (unqualifiedAccessExpr
                          (identifier))
                        (unqualifiedAccessExpr
                          (identifier))))))
                (identifier)
                (argumentList
                  (intLiteralExpr)
                  (intLiteralExpr)))))))))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier)))
          (functionLiteralExpr
            (parameterList
              (typedIdentifier
                (identifier)))
            (newExpr
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (objectBody
                (objectProperty
                  (identifier)
                  (unqualifiedAccessExpr
                    (identifier))))))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (unqualifiedAccessExpr
            (identifier))
          (identifier)
          (argumentList
            (functionLiteralExpr
              (parameterList)
              (qualifiedAccessExpr
                (qualifiedAccessExpr
                  (amendExpr
                    (parenthesizedExpr
                      (unqualifiedAccessExpr
                        (identifier)))
                    (objectBody
                      (objectBodyParameters

                        (typedIdentifier
                          (identifier)
                          (typeAnnotation
                            (declaredType
                              (qualifiedIdentifier
                                (identifier)))))
                        (typedIdentifier
                          (identifier)))
                      (objectProperty
                        (identifier)
                        (unqualifiedAccessExpr
                          (identifier)))
                      (objectProperty
                        (identifier)
                        (unqualifiedAccessExpr
                          (identifier)))))
                  (identifier)
                  (argumentList
                    (intLiteralExpr)
                    (intLiteralExpr)))
                (identifier)
                (argumentList
                  (intLiteralExpr)))))))))
  (clazz
    (identifier))
  (clazz
    (identifier))
  (clazz
    (identifier))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier)))
          (newExpr
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (objectBody
              (objectProperty
                (identifier)
                (unqualifiedAccessExpr
                  (identifier)))))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (amendExpr
            (parenthesizedExpr
              (unqualifiedAccessExpr
                (identifier)))
            (objectBody
              (objectBodyParameters

                (typedIdentifier
                  (identifier)
                  (typeAnnotation
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))))
                (typedIdentifier
                  (identifier)
                  (typeAnnotation
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))))
                (typedIdentifier
                  (identifier)
                  (typeAnnotation
                    (declaredType
                      (qualifiedIdentifier
                        (identifier))))))
              (objectProperty
                (identifier)
                (unqualifiedAccessExpr
                  (identifier)))
              (objectProperty
                (identifier)
                (unqualifiedAccessExpr
                  (identifier)))))
          (identifier)
          (argumentList
            (newExpr
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (objectBody))
            (newExpr
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (objectBody))
            (newExpr
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (objectBody)))))))
  (classProperty
    (identifier)
    (objectBody
      (objectProperty
        (modifier)
        (identifier)
        (functionLiteralExpr
          (parameterList
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier))
            (typedIdentifier
              (identifier)))
          (newExpr
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (objectBody
              (objectProperty
                (identifier)
                (unqualifiedAccessExpr
                  (identifier)))))))
      (objectProperty
        (identifier)
        (qualifiedAccessExpr
          (unqualifiedAccessExpr
            (identifier))
          (identifier)
          (argumentList
            (functionLiteralExpr
              (parameterList)
              (qualifiedAccessExpr
                (amendExpr
                  (parenthesizedExpr
                    (unqualifiedAccessExpr
                      (identifier)))
                  (objectBody
                    (objectBodyParameters

                      (typedIdentifier
                        (identifier)
                        (typeAnnotation
                          (declaredType
                            (qualifiedIdentifier
                              (identifier)))))
                      (typedIdentifier
                        (identifier)
                        (typeAnnotation
                          (declaredType
                            (qualifiedIdentifier
                              (identifier)))))
                      (typedIdentifier
                        (identifier)
                        (typeAnnotation
                          (declaredType
                            (qualifiedIdentifier
                              (identifier))))))
                    (objectProperty
                      (identifier)
                      (unqualifiedAccessExpr
                        (identifier)))
                    (objectProperty
                      (identifier)
                      (unqualifiedAccessExpr
                        (identifier)))))
                (identifier)
                (argumentList
                  (newExpr
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))
                    (objectBody))
                  (newExpr
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))
                    (objectBody))
                  (newExpr
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))
                    (objectBody)))))))))))