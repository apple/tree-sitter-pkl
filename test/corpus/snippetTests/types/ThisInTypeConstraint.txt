===
types/ThisInTypeConstraint.pkl
===

res1: List<String(this == "one")>(this is List) = List("one")

res2: Mapping<String(this == "one"), String(this == "one")>(this is Mapping) = new Mapping { ["one"] = "one" }

res3: List<Set<String(this == "one")>(this is Set)>(this is List) = List(Set("one"), Set("one"))

res4: List<String(this == "one", (() -> this).apply() == "one", (let (x = this) x) == "one")> = List("one")

res5 = new Clazz {}

res6 = fun(res3)

class Clazz {
  res1: List<String(this == "one")>(this is List) = List("one")

  res2: Mapping<String(this == "one"), String(this == "one")>(this is Mapping) = new Mapping { ["one"] = "one" }

  res3: List<List<String(this == "one")>(this is List)>(this is List) = List(List("one"), List("one"))
}

function fun(x: List<Set<String(this == "one")>(this is Set)>(this is List)) = x


---

(module
  (classProperty
    (identifier)
    (typeAnnotation
      (constrainedType
        (declaredType
          (qualifiedIdentifier
            (identifier))
          (typeArgumentList
            (constrainedType
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (equalityExpr
                (thisExpr)
                (slStringLiteralExpr
                  (slStringLiteralPart))))))
        (typeTestExpr
          (thisExpr)
          (declaredType
            (qualifiedIdentifier
              (identifier))))))
    (unqualifiedAccessExpr
      (identifier)
      (argumentList
        (slStringLiteralExpr
          (slStringLiteralPart)))))
  (classProperty
    (identifier)
    (typeAnnotation
      (constrainedType
        (declaredType
          (qualifiedIdentifier
            (identifier))
          (typeArgumentList
            (constrainedType
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (equalityExpr
                (thisExpr)
                (slStringLiteralExpr
                  (slStringLiteralPart))))
            (constrainedType
              (declaredType
                (qualifiedIdentifier
                  (identifier)))
              (equalityExpr
                (thisExpr)
                (slStringLiteralExpr
                  (slStringLiteralPart))))))
        (typeTestExpr
          (thisExpr)
          (declaredType
            (qualifiedIdentifier
              (identifier))))))
    (newExpr
      (declaredType
        (qualifiedIdentifier
          (identifier)))
      (objectBody
        (objectEntry
          (slStringLiteralExpr
            (slStringLiteralPart))
          (slStringLiteralExpr
            (slStringLiteralPart))))))
  (classProperty
    (identifier)
    (typeAnnotation
      (constrainedType
        (declaredType
          (qualifiedIdentifier
            (identifier))
          (typeArgumentList
            (constrainedType
              (declaredType
                (qualifiedIdentifier
                  (identifier))
                (typeArgumentList
                  (constrainedType
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))
                    (equalityExpr
                      (thisExpr)
                      (slStringLiteralExpr
                        (slStringLiteralPart))))))
              (typeTestExpr
                (thisExpr)
                (declaredType
                  (qualifiedIdentifier
                    (identifier)))))))
        (typeTestExpr
          (thisExpr)
          (declaredType
            (qualifiedIdentifier
              (identifier))))))
    (unqualifiedAccessExpr
      (identifier)
      (argumentList
        (unqualifiedAccessExpr
          (identifier)
          (argumentList
            (slStringLiteralExpr
              (slStringLiteralPart))))
        (unqualifiedAccessExpr
          (identifier)
          (argumentList
            (slStringLiteralExpr
              (slStringLiteralPart)))))))
  (classProperty
    (identifier)
    (typeAnnotation
      (declaredType
        (qualifiedIdentifier
          (identifier))
        (typeArgumentList
          (constrainedType
            (declaredType
              (qualifiedIdentifier
                (identifier)))
            (equalityExpr
              (thisExpr)
              (slStringLiteralExpr
                (slStringLiteralPart)))
            (equalityExpr
              (qualifiedAccessExpr
                (parenthesizedExpr
                  (functionLiteralExpr
                    (parameterList)
                    (thisExpr)))
                (identifier)
                (argumentList))
              (slStringLiteralExpr
                (slStringLiteralPart)))
            (equalityExpr
              (parenthesizedExpr
                (letExpr
                  (typedIdentifier
                    (identifier))
                  (thisExpr)
                  (unqualifiedAccessExpr
                    (identifier))))
              (slStringLiteralExpr
                (slStringLiteralPart)))))))
    (unqualifiedAccessExpr
      (identifier)
      (argumentList
        (slStringLiteralExpr
          (slStringLiteralPart)))))
  (classProperty
    (identifier)
    (newExpr
      (declaredType
        (qualifiedIdentifier
          (identifier)))
      (objectBody)))
  (classProperty
    (identifier)
    (unqualifiedAccessExpr
      (identifier)
      (argumentList
        (unqualifiedAccessExpr
          (identifier)))))
  (clazz
    (identifier)
    (classBody
      (classProperty
        (identifier)
        (typeAnnotation
          (constrainedType
            (declaredType
              (qualifiedIdentifier
                (identifier))
              (typeArgumentList
                (constrainedType
                  (declaredType
                    (qualifiedIdentifier
                      (identifier)))
                  (equalityExpr
                    (thisExpr)
                    (slStringLiteralExpr
                      (slStringLiteralPart))))))
            (typeTestExpr
              (thisExpr)
              (declaredType
                (qualifiedIdentifier
                  (identifier))))))
        (unqualifiedAccessExpr
          (identifier)
          (argumentList
            (slStringLiteralExpr
              (slStringLiteralPart)))))
      (classProperty
        (identifier)
        (typeAnnotation
          (constrainedType
            (declaredType
              (qualifiedIdentifier
                (identifier))
              (typeArgumentList
                (constrainedType
                  (declaredType
                    (qualifiedIdentifier
                      (identifier)))
                  (equalityExpr
                    (thisExpr)
                    (slStringLiteralExpr
                      (slStringLiteralPart))))
                (constrainedType
                  (declaredType
                    (qualifiedIdentifier
                      (identifier)))
                  (equalityExpr
                    (thisExpr)
                    (slStringLiteralExpr
                      (slStringLiteralPart))))))
            (typeTestExpr
              (thisExpr)
              (declaredType
                (qualifiedIdentifier
                  (identifier))))))
        (newExpr
          (declaredType
            (qualifiedIdentifier
              (identifier)))
          (objectBody
            (objectEntry
              (slStringLiteralExpr
                (slStringLiteralPart))
              (slStringLiteralExpr
                (slStringLiteralPart))))))
      (classProperty
        (identifier)
        (typeAnnotation
          (constrainedType
            (declaredType
              (qualifiedIdentifier
                (identifier))
              (typeArgumentList
                (constrainedType
                  (declaredType
                    (qualifiedIdentifier
                      (identifier))
                    (typeArgumentList
                      (constrainedType
                        (declaredType
                          (qualifiedIdentifier
                            (identifier)))
                        (equalityExpr
                          (thisExpr)
                          (slStringLiteralExpr
                            (slStringLiteralPart))))))
                  (typeTestExpr
                    (thisExpr)
                    (declaredType
                      (qualifiedIdentifier
                        (identifier)))))))
            (typeTestExpr
              (thisExpr)
              (declaredType
                (qualifiedIdentifier
                  (identifier))))))
        (unqualifiedAccessExpr
          (identifier)
          (argumentList
            (unqualifiedAccessExpr
              (identifier)
              (argumentList
                (slStringLiteralExpr
                  (slStringLiteralPart))))
            (unqualifiedAccessExpr
              (identifier)
              (argumentList
                (slStringLiteralExpr
                  (slStringLiteralPart)))))))))
  (classMethod
    (methodHeader
      (identifier)
      (parameterList
        (typedIdentifier
          (identifier)
          (typeAnnotation
            (constrainedType
              (declaredType
                (qualifiedIdentifier
                  (identifier))
                (typeArgumentList
                  (constrainedType
                    (declaredType
                      (qualifiedIdentifier
                        (identifier))
                      (typeArgumentList
                        (constrainedType
                          (declaredType
                            (qualifiedIdentifier
                              (identifier)))
                          (equalityExpr
                            (thisExpr)
                            (slStringLiteralExpr
                              (slStringLiteralPart))))))
                    (typeTestExpr
                      (thisExpr)
                      (declaredType
                        (qualifiedIdentifier
                          (identifier)))))))
              (typeTestExpr
                (thisExpr)
                (declaredType
                  (qualifiedIdentifier
                    (identifier)))))))))
    (unqualifiedAccessExpr
      (identifier))))